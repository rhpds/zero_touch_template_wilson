= Module 2.4: Deploy & Test Your Lab
:estimated-time: 15-20 minutes

== Learning Objectives

Upon completion, you will understand:

* Lab deployment to the Zero Touch platform
* Lab environment functionality testing
* Student access and experience verification
* Common deployment issue troubleshooting

== Overview

You've configured infrastructure, networking, and content. Now it's time to deploy your lab and make sure everything works as expected for students.

== Step 1: Pre-Deployment Checklist

Before deploying, verify your configuration:

[source,bash]
----
# Check all required files exist
ls -la config/
ls -la content/modules/ROOT/pages/
----

.Expected Files
----
config/
├── instances.yaml    # VMs and containers
├── networks.yaml     # Network topology  
├── firewall.yaml     # Security rules
ui-config.yml         # Navigation
site.yml              # Antora configuration
----

=== Validate Configuration Files

[source,bash]
----
# Check YAML syntax
python3 -c "import yaml; yaml.safe_load(open('config/instances.yaml'))"
python3 -c "import yaml; yaml.safe_load(open('config/networks.yaml'))"
python3 -c "import yaml; yaml.safe_load(open('config/firewall.yaml'))"
----

If no errors appear, your YAML is valid.

== Step 2: Build Documentation

Generate your lab content:

[source,bash]
----
# Build documentation
antora generate site.yml
----

.Expected Output
----
[12:34:56.789] INFO (antora): Documents converted successfully
Site generation complete!
----

=== Test Local Preview (if available)

[source,bash]
----
# Serve locally to test
antora serve site.yml
----

Navigate to `http://localhost:5000` to preview your lab.

== Step 3: Commit and Deploy

Push your changes to trigger deployment:

[source,bash]
----
# Add all changes
git add .

# Commit with descriptive message
git commit -m "Lab ready for deployment"

# Push to trigger deployment
git push origin main
----

== Step 4: Test Lab Access

Once deployed, test the student experience:

=== Access Your Lab

[source,bash]
----
# Access will be provided via lab platform
# Typically: https://your-lab-url.demo.redhat.com
----

=== Test Terminal Access

* Click terminal tabs in the UI
* Verify SSH connectivity to VMs
* Test copy+run buttons on commands

=== Test VM Functionality

[source,bash]
----
# From lab terminal, test VMs
hostname
ip addr show
ping google.com
----

=== Test Container Services

If you have containers:

[source,bash]
----
# Check container connectivity
curl http://container-name:port
nc -zv container-name port
----

== Step 5: Student Experience Test

Navigate through your content as a student would:

1. **Start with landing page** - Clear objectives?
2. **Follow instructions** - Copy+run buttons work?
3. **Complete each step** - Validation points clear?
4. **Check navigation** - Can students find their way?

== Deployment Checklist

Verify each item works:

- [ ] **Lab loads** without errors
- [ ] **Terminal access** available
- [ ] **VM connectivity** functional
- [ ] **Container services** accessible
- [ ] **Copy+run buttons** working
- [ ] **Navigation** clear and logical
- [ ] **Content** displays properly
- [ ] **Links** functional

== Common Issues & Solutions

**Lab doesn't load?**
→ Check YAML syntax in configuration files

**Terminal access fails?**
→ Verify firewall rules allow SSH (port 22)

**VMs unreachable?**
→ Check VM status and network configuration

**Containers not responding?**  
→ Verify container image names and ports

**Content not displaying?**
→ Check AsciiDoc syntax and file locations

**Navigation missing?**
→ Verify ui-config.yml module names match files

== Summary

Congratulations! You have:

* **Built a complete lab environment** with VMs, containers, and networking  
* **Created engaging educational content** with interactive features  
* **Deployed to the Zero Touch platform** successfully  
* **Tested the student experience** end-to-end  
* **Learned troubleshooting techniques** for common issues  

You're now ready to create professional, interactive labs for your students!

== Next Steps

=== Enhance Your Lab
* xref:production-patterns-guide.adoc[Production Patterns] - Learn from real-world labs
* xref:advanced-lab-features.adoc[Advanced Features] - Add sophisticated capabilities
* xref:enterprise-lab-patterns.adoc[Enterprise Patterns] - Scale to organizational needs

=== Share Your Success
* Document lessons learned
* Share your lab template with colleagues
* Contribute improvements back to the platform

=== Continue Learning
* Explore the complete reference guides
* Join the Zero Touch community
* Build more advanced lab environments

Welcome to the Zero Touch platform developer community.

[bibliography]
== References

* [[[template-setup]]] Red Hat GPTE Team. Zero Touch Template Setup Automation. 
  `/home/wilson/Projects/zero_touch_template_wilson/setup-automation/main.yml`. 2024.

* [[[template-instances]]] Red Hat GPTE Team. Zero Touch Template Instance Configuration. 
  `/home/wilson/Projects/zero_touch_template_wilson/config/instances.yaml`. 2024.

* [[[agnosticd-base]]] Red Hat GPTE Team. AgnosticD Zero Touch Base RHEL Configuration. 
  `/home/wilson/Projects/agnosticd/ansible/configs/zero-touch-base-rhel/default_vars_openshift_cnv.yaml`. 2024.
